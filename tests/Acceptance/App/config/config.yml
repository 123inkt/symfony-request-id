parameters:
  secret: dev
  locale: en

framework:
  test: ~
  secret: "%secret%"
  router:
    resource: "%kernel.project_dir%/config/routing.yml"
    strict_requirements: "%kernel.debug%"
    utf8: true
  messenger:
    transports:
      test_transport: 'sync://'
    routing:
      DR\SymfonyRequestId\Tests\Acceptance\App\Messenger\TestMessage: test_transport
  http_method_override: false
  php_errors:
    log: true
  handle_all_throwables: true
  default_locale: "%locale%"

symfony_request_id:
  request_header: Request-Id
  response_header: Request-Id
  trust_request_header: true

twig:
  strict_variables: "%kernel.debug%"
  paths:
    "%kernel.project_dir%/templates": requestid

services:
  log.formatter:
    class: Monolog\Formatter\LineFormatter
    arguments:
      - "[%%level_name%% - %%extra.request_id%%] %%message%%"
  log.memory_handler:
    public: true
    class: DR\SymfonyRequestId\Tests\Acceptance\App\Monolog\MemoryHandler
    calls:
      - [ setFormatter, [ "@log.formatter" ] ]
  message.handler:
    class: DR\SymfonyRequestId\Tests\Acceptance\App\Messenger\TestMessageHandler
    tags:
      - { name: messenger.message_handler, from_transport: test_transport, method: __invoke }

monolog:
  handlers:
    main:
      type: service
      id: log.memory_handler
